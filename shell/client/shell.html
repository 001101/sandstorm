<head>
  <title>Sandstorm</title>
  <!-- TODO(soon):  Host font locally. -->
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,600' rel='stylesheet' type='text/css'>
  <script type="text/javascript" src="/logo.js"></script>
</head>

<body>
  <div id="topbar-left">
    {{> grainList}}
  </div>
  <div id="topbar">
    Sandstorm
  </div>
  <div id="topbar-right">
  </div>
</body>

<template name="grainList">
  <img class="icon" src="/apps.svg" title="apps" id="apps-ico">
  <div id="apps" class="popup">
    <h1>My Grains</h1>
    {{#each grains}}
    <p class="openGrain" id="openGrain-{{grainid}}">{{title}}
    {{/each}}
    <hr>
    {{#each actions}}
    <p class="newGrain" id="newGrain-{{_id}}">{{title}}
    {{/each}}
  </div>
</template>

<template name="root">
  <div id="intro">
    <div id="logo">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">
      </svg>
    </div>
    <h1>Sandstorm</h1>
    <p>Looking for an app?
      <a href="install?appid=81d4758636d6a947dc3e6825f080199a&url=http://{{host}}/etherpad.spk">
      Try Etherpad</a>
  </div>
</template>

<template name="grain">
  <div id="app">
    {{#if error}}
      <pre>{{error}}</pre>
    {{else}}
    {{#if port}}
      <iframe src="http://localhost:{{port}}/_sandstorm-init?sessionid={{sessionid}}"></iframe>
    {{else}}
      <p>Loading app...
    {{/if}}
    {{/if}}
  </div>
</template>

<template name="install">
  {{#if error}}
    <div id="install" class="error">
      <p>Failed to install app!  <button id="retry">Try Again</button>
      <pre>{{error}}</pre>
    </div>
  {{else}}
    <div id="install" class="instep-{{step}}">
      <ol>
        <li id="step-download">Download... <span class="progress">{{progress}}
            <button id="cancelDownload">Cancel</button></span>
        <li id="step-verify">Verify... <span class="progress">{{progress}}</span>
        <li id="step-unpack">Unpack... <span class="progress">{{progress}}</span>
        <li id="step-analyze">Analyze... <span class="progress">{{progress}}</span>
        <li id="step-confirm">Confirm...
          <div class="confirm-form">
            <p>(TODO:  Support upgrades, petnames.)
            <p><button id="confirmInstall">Install</button>
          </div>
        <li id="step-run">Run...
      </ol>
    </div>
  {{/if}}
</template>
