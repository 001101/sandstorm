<!--
Sandstorm - Personal Cloud Sandbox
Copyright (c) 2015 Sandstorm Development Group, Inc. and contributors
All rights reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<template name="sandstormTopbar">
  <!-- Becomes hamburger menu button in mobile view. -->
  <div class="menu-button"></div>

  {{#if isUpdateBlocked}}
    <div class="topbar-update">
      Sandstorm has been updated &mdash; Click here to reload
    </div>
  {{else}}
    <ul class="topbar">
      {{#each items}}
        <li class="{{name}}">
          {{> template data}}
        </li>
      {{/each}}
    </ul>
  {{/if}}
</template>

<template name="sandstormTopbarItem">
  {{!--
    Convenience helper for registering topbar items.

    You can insert something like this into a template to indicate that while the template is
    displayed, an item should be added to the top bar:

        {{>sandstormTopbarItem name="foo" topbar=myTopbar data="whatever" template="fooTemplate"}}

    The topbar item will use the given template. The template will receive `data` as its data
    context.

    The effect is that as long as the parent template is instantiated, the inner part will be
    registered as a topbar item. When the parent template is disposed, the template item will
    be unregistered. MAGIC!

    The parameter `topbar` refers to the SandstormTopbar object with which to register the item.

    As a special hack, you can also use this template like so:

        {{#sandstormTopbarItem name="foo" topbar=myTopbar}}
          inline template!!!
        {{/sandstormTopbarItem}}

    This syntax essentially defines `template` inline. Note, however, that because these template
    will not be inserted directly into the parent template, there are some limitations:

    * Event handlers on the parent template will NOT catch events on the topbar items.
    * If you don't specify `data`, the current context will be inherited. However, its parents
      will NOT be inherited, so you can't use Template.parentData() to get them.
    * Helper functions on the parent template CAN be used in the topbar items, though.
  --}}
</template>

<template name="sandstormTopbarPopup">
  {{!--
    Use this inside of a topbar item template to define a popup that will appear when clicked,
    like (replacing [] with <>):

        [template name="whatever"]
          My Item

          {{#sandstormTopbarPopup}}
            <p>My popup</p>
          {{/sandstormTopbarPopup}}
        [/template]

    This should always be the last thing in the parent template, not nested in any tags or
    template blocks.
  --}}
  {{#if isExpanded}}
    <div class="closer">
      <div class="popup" style="{{position}}">
        {{> Template.contentBlock}}
      </div>
    </div>
  {{/if}}
</template>

<template name="sandstormTopbarBlockReload">
  {{!--
    Convenience template that blocks reload while it exists. Embed this in any UI which would
    be bad to unexpectedly reload on hot code update.
  --}}
</template>
