1. Make a copy openssl.cnf:
  cp /etc/ssl/openssl.cnf [directory_you_want_copy_to_be]

2. Add the following to the end of the copied openssl.cnf file:
  [req]
  req_extensions = v3_req

  [ v3_req ]

  # Extensions to add to a certificate request

  basicConstraints = CA:FALSE
  keyUsage = nonRepudiation, digitalSignature, keyEncipherment
  subjectAltName = @alt_names

  [alt_names]
  DNS.1 = [your-domain-name].sandcats.io
  DNS.2 = *.[your-domain-name].sandcats.io

3. Create the Certificate Authority (CA) Key:
  openssl genrsa -out rootCA.key 4096

4. rootCA.key is the file for the Certificate Authority (CA) key.

5. Sign the Certificate Authority (CA) Key and Create Certificate Authority (CA) certificate (Expires in 10 years):
  openssl req -x509 -new -nodes -key rootCA.key -days 3650 -out rootCA.pem

rootCA.pem is the file for the Certificate Authority (CA) certificate

6. Create Sandstorm Device Private Key:
  openssl genrsa -out sandstorm.key 4096

sandstorm.key is the Sandstorm Device Private Key

7. Create Sandstorm Device Certificate Signing Request (CSR) using the copied and edited openssl.cnf file:
  openssl req -new -key sandstorm.key -out sandstorm.csr -config openssl.cnf

sandstorm.csr is the Sandstorm Device Certificate Signing Request (CSR)

8. Create and sign the Sandstorm Certificate (Expire in 2 years):
  openssl x509 -req -in sandstorm.csr -CA rootCA.pem -CAkey rootCA.key -CAcreateserial -out sandstorm.crt -days 730 -extensions v3_req -extfile openssl.cnf

sandstorm.crt is the Sandstorm Certificate

9. Import the Certificate Authority (CA) Certificate (rootCA.pem) into the browser's that will be using Sandstorm.

10. Copy (FTP/SSH) the Sandstorm Certificate and Sandstorm Private Key to the nginx ssl directory, it may be /etc/nginx/ssl.

11. Change these lines in your nginx conf file to reflect the new Sandstorm Certificate and Private Key filenames:
  ssl_certificate /etc/nginx/ssl/sandstorm.crt;
  ssl_certificate_key /etc/nginx/ssl/sandstorm.key;

11. Restart nginx:
  sudo service nginx restart

12. Restart Sandstorm:
  sudo sandstorm restart (or sudo /opt/sandstorm/sandstorm restart)


Created with help from:
https://docs.sandstorm.io/en/latest/administering/reverse-proxy/
http://datacenteroverlords.com/2012/03/01/creating-your-own-ssl-certificate-authority/
https://wiki.cacert.org/FAQ/subjectAltName
http://www.codeproject.com/Tips/833087/X-SSL-Certificates-With-Custom-Extensions
http://markmail.org/message/grfu4qkr5v5xttc2
http://blog.loftninjas.org/2008/11/11/configuring-ssl-requests-with-subjectaltname-with-openssl/
